## Lab Description: CSRF where token validation depends on token being present

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/7d27108f-8f6b-4013-8560-d2b234011007)

## Solution:

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/f1961a85-5b28-4f99-98bd-a7e2ec17777f)

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/2d35c6b7-4253-469b-8907-e65e33fd319f)

Post request can change the email only an extra parameter we can remove 

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/fa21c93c-837d-423b-8c76-fddb20b6e17f)

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/8c6bfc79-060c-43bf-8bbf-384d5e226f79)

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/c272074b-951d-4bd3-82a1-88873e19a3e7)

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/15ef0a00-4cee-41bb-8b5e-ebbdfdc4d4e6)

Upload it to an exploit server on portswigger 

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/3f6aedb9-9483-4093-b31c-1743367dc8fc)

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/156fb098-2e81-44e9-a325-22ba45f90a17)
